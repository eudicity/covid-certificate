import { verifySignature } from "./verifySignature";
import { readCertificate } from "../parse/readCertificate";

test("verify", () => {
  const dcc =
    "HC1:NCF8%ASJOQP2J40$FED%OMCD*LOPEI6TQ6/IN7S:S7P%8J1QQT6%WNT%PXHKMIS0ETVHJWRV CSWJR6T9QN0BG10QE-4PFT7-3G68S-/C.D2Z8CA1A08L 1L7-B24H91859PH:QSW3-8L36CNFT2ZM1 MR6EQZMF.L.7WN0OFLF:EWW3M3SD971Y2UT5OZOHJ1P2E9LF80IO948AO0.DHYNKKTJ$:J$PPE5W4ZD8CT5IAT-KGV12O2FF4+NJ4QGBV9QGU%FAYCQWH6QTV:*D.:4-$74FBZEN4+EJZGPLVJ2D6S8 S4AFIF54N/7%FJ21FEYKMEU2-9X5J1J1G7L*+9N-0H6CZI3J1J $5/56.J41WCI88:NA00M8.BTJBMOM/A9872TZUAA0WLK%007INON1V6DX30RAH0LBP%5X.AU71GCRVWSFM6W5S3/6M-4AHFS4AAH4X3TI-4.I6$G1:NQJMQIVFJRI4 2MOU1OMJMTZSB5UHZSHL*S2KJK*4QN1IRGR48$K3981J:A+BW6DF1:ETDTYWLH3775R8:3:TVS4N :RGIE%/M+6EMMBC6HH6K%324YVUWEPK0E1KR.75-R1/B-$U::OWJSI6JS6GQ:GPN7K*UECD4GV8P3N8J";
  const issuerCert =
    "MIIBWTCCAQCgAwIBAgIFANvWRK8wCgYIKoZIzj0EAwIwEDEOMAwGA1UEAwwFRUMtTWUwHhcNMjEwNTAzMTgwMDAwWhcNMjEwNjAyMTgwMDAwWjAQMQ4wDAYDVQQDDAVFQy1NZTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABGVcamJVe0KjWa95H5eLg13x7+Uu372z+eBx97ShzzxD2h0a+sdvsZCaB5naJC5GpgU0Ud1hyeB4FkNEpxbxWwejRzBFMA4GA1UdDwEB/wQEAwIFoDAzBgNVHSUELDAqBgwrBgEEAQCON49lAQEGDCsGAQQBAI43j2UBAgYMKwYBBAEAjjePZQEDMAoGCCqGSM49BAMCA0cAMEQCIBFpJpjU/0aSHmFU6cNnoreGLVmf9FWz8SGsOF1p6O1oAiA2lZT7fdZE0qA6HRleUsKklQreXtco0YCPMhIAsl1GBA=="
  const result = verifySignature(readCertificate(dcc), {
    kid: 'somekid',
    rawData: issuerCert,
  }, new Date("2021-05-03T18:00:00Z"));
  expect(result.isValid()).toBe(true);
});
